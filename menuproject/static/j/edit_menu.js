// Generated by CoffeeScript 1.4.0
(function() {

  $(function() {
    $("form").submit(function() {
      $(this).submit(function() {
        return false;
      });
      return true;
    });
    $('#add-menu-item').click(function() {
      $('#add-menu-item-modal').addClass("display");
      $('#add-menu-item-modal-wrap').addClass("display");
    });
    $('.cancel').click(function() {
      $('#add-menu-item-modal-wrap').removeClass('display');
      $('#add-menu-item-modal').removeClass('display');
    });
    return $('.delete').click(function() {
      return $.ajax({
        type: "POST",
        url: "/delete_menu_item/" + $(this).attr("menu_item_id")
      }).done(function(data) {
        var item_to_remove;
        return item_to_remove = $(".menu .dish").filter("#" + data).remove();
      });
    });
  });

  $('#menuTitle').live('change', function() {
    return $.ajax({
      type: "POST",
      url: "/update_menu_name/" + $(this).attr("menu_id"),
      data: JSON.stringify(escape($(this).val())),
      contentType: 'application/json; charset=utf-8'
    }).done(function(data) {
      return $('#menuTitle').val(JSON.parse(data));
    });
  });

  $('.menu .dish-title').live('change', function() {
    return $.ajax({
      type: 'POST',
      url: "/update_menu_item_name/" + $(this)[0].getAttribute("menu_item_id"),
      data: JSON.stringify(escape($(this).val())),
      contentType: 'application/json; charset=utf-8'
    }).done(function(data) {
      return $('#menuTitle').val(JSON.parse(data));
    });
  });

  $('.menu .description').live('change', function() {
    return $.ajax({
      type: "POST",
      url: "/update_menu_item_desc/" + $(this)[0].getAttribute('menu_item_id'),
      data: JSON.stringify(escape($(this).val())),
      contentType: 'application/json; charset=utf8'
    });
  });

  $('.menu .checkbox#allergen').live('change', function() {
    var data_name;
    data_name = $(this).is(":checked") ? "menu_item_allergen_on=" : "menu_item_allergen_off=";
    return $.ajax({
      type: "POST",
      url: "/update_menu_item_allergen/" + $(this)[0].getAttribute('menu_item_id'),
      data: data_name + $(this)[0].getAttribute('allergenName')
    });
  });

  $('.menu .healthy-selection').live('change', function() {
    return $.ajax({
      type: "POST",
      url: "/update_menu_item_healthy/" + $(this)[0].getAttribute('menu_item_id'),
      data: "healthy=" + $(this).val()
    });
  });

  $(function() {
    $("#sortable").sortable({
      update: function(event, ui) {
        var menu_id, new_order;
        new_order = $(this).sortable('toArray').toString();
        menu_id = $(".menu ul").attr("menu_id");
        return $.ajax({
          type: "POST",
          url: "/update_menu_order/" + menu_id,
          data: "menu_ids=" + new_order
        });
      }
    });
    return $("#sortable").disableSelection();
  });

}).call(this);
